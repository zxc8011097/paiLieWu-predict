<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¶³çƒAIæ·±åº¦é¢„æµ‹ç³»ç»Ÿ - å•†ä¸šæ——èˆ°ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Microsoft YaHei", sans-serif;
        }

        :root {
            --primary: #165DFF;
            --primary-light: #E8F3FF;
            --vip: #FF4080;
            --vip-light: #FFF0F5;
            --secondary: #36CFC9;
            --danger: #F53F3F;
            --warning: #FF7D00;
            --success: #00B42A;
            --gray-100: #F2F3F5;
            --gray-200: #E5E6EB;
            --gray-300: #C9CDD4;
            --gray-600: #4E5969;
            --gray-800: #1D2129;
            --white: #FFFFFF;
            --radius: 16px;
            --shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }

        .dark-mode {
            --bg: #121418;
            --card: #1D2129;
            --text: #E5E6EB;
            --border: #33363D;
            --primary-light: #293552;
            --vip-light: #3D2335;
        }

        body {
            background: var(--gray-100);
            color: var(--gray-800);
            transition: var(--transition);
            padding-bottom: 40px;
        }

        .dark-mode {
            background: #121418;
            color: var(--text);
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .navbar {
            background: var(--white);
            border-radius: var(--radius);
            padding: 16px 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            position: relative; z-index: 10;
        }

        .dark-mode .navbar { background: var(--card); }

        .navbar h1 { font-size: 20px; color: var(--primary); font-weight: 700; }

        .nav-buttons { display: flex; gap: 8px; align-items: center; }

        .vip-tag { background: var(--vip); color: #fff; font-size: 12px; padding: 3px 6px; border-radius: 6px; font-weight: bold; }

        .btn {
            padding: 8px 14px; border-radius: 10px; font-size: 14px; font-weight: 500;
            border: none; cursor: pointer; transition: var(--transition);
            display: inline-flex; align-items: center; justify-content: center;
        }

        .btn-primary { background: var(--primary); color: #fff; }
        .btn-primary:hover { background: #0D47A1; }
        .btn-vip { background: var(--vip); color: #fff; }
        .btn-outline { background: transparent; border: 1px solid var(--primary); color: var(--primary); }
        .btn-danger { background: var(--danger); color: #fff; }

        .card {
            background: var(--white); border-radius: var(--radius); padding: 24px;
            margin-bottom: 16px; box-shadow: var(--shadow); transition: var(--transition);
        }
        .dark-mode .card { background: var(--card); }

        .card-title {
            font-size: 16px; font-weight: 600; color: var(--gray-800); margin-bottom: 16px;
            display: flex; align-items: center; gap: 8px;
        }
        .dark-mode .card-title { color: var(--text); }
        .card-title i { color: var(--primary); font-style: normal; }

        input, select {
            width: 100%; padding: 12px 14px; border-radius: 10px;
            border: 1px solid var(--gray-200); background: var(--white);
            color: var(--gray-800); margin-bottom: 12px; font-size: 15px; transition: var(--transition);
        }
        .dark-mode input,.dark-mode select { background: #252A34; border-color: #33363D; color: var(--text); }
        input:focus { outline: none; border-color: var(--primary); }

        .countdown {
            font-size: 18px; font-weight: 700; color: var(--danger);
            text-align: center; padding: 12px; background: var(--primary-light); border-radius: 12px;
        }

        .stats { display: flex; flex-wrap: wrap; gap: 8px; }
        .stats span { padding: 6px 10px; background: var(--primary-light); color: var(--primary); border-radius: 8px; font-size: 13px; font-weight: 500; }

        .balls { display: flex; gap: 12px; justify-content: center; margin: 16px 0; }
        .ball {
            width: 52px; height: 52px; border-radius: 50%; background: var(--primary); color: #fff;
            display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: 700;
            box-shadow: 0 4px 12px rgba(22, 93, 255, 0.3);
        }

        .num-ball {
            width: 28px; height: 28px; border-radius: 50%; background: var(--primary); color: #fff;
            display: inline-flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600;
        }

        .grid5 { display: grid; grid-template-columns: repeat(5,1fr); gap: 10px; }
        .item { background: var(--primary-light); border-radius: 12px; padding: 16px 10px; text-align: center; font-size: 14px; }
        .item strong { font-size: 16px; color: var(--primary); }

        .chart-box { overflow-x: auto; border-radius: 12px; }
        .trend-table { width: 100%; border-collapse: collapse; font-size: 14px; }
        .trend-table th { background: var(--primary-light); color: var(--primary); padding: 10px; font-weight: 600; text-align: center; }
        .trend-table td { padding: 10px; text-align: center; border-bottom: 1px solid var(--gray-200); }
        .dark-mode .trend-table td { border-color: var(--border); }

        .history-item {
            display: flex; justify-content: space-between; padding: 12px 0;
            border-bottom: 1px dashed var(--gray-200); font-size: 15px;
        }
        .dark-mode .history-item { border-color: var(--border); }

        .shape-box { display: flex; gap: 10px; flex-wrap: wrap; }
        .shape { flex: 1; min-width: 100px; background: var(--primary-light); border-radius: 12px; padding: 12px; text-align: center; font-size: 14px; }

        .tip { font-size: 12px; color: var(--gray-600); text-align: center; margin-top: 8px; }
        .dark-mode .tip { color: var(--gray-300); }
        .rate { color: var(--danger); font-weight: 600; font-size: 15px; text-align: center; margin-top: 8px; }

        .loading,.update-bar { text-align: center; padding: 10px; color: var(--primary); font-size: 14px; display: none; }
        .update-bar { background: var(--primary-light); border-radius: 10px; margin-bottom: 10px; }

        .login-lock,.ad-lock {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--gray-100); display: flex; align-items: center; justify-content: center; z-index: 9999;
        }
        .dark-mode .login-lock,.dark-mode .ad-lock { background: #121418; }

        .login-box,.ad-box {
            width: 90%; max-width: 400px; background: var(--white); border-radius: 20px;
            padding: 40px 30px; box-shadow: 0 12px 32px rgba(0,0,0,0.1); text-align: center;
        }
        .dark-mode .login-box,.dark-mode .ad-box { background: var(--card); }
        .login-box h2,.ad-box h2 { margin-bottom: 24px; color: var(--primary); }

        .vip-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center; z-index: 9998;
        }
        .vip-box { width: 90%; max-width: 400px; background: var(--white); border-radius: 20px; padding: 30px; text-align: center; }
        .dark-mode .vip-box { background: var(--card); }
        .vip-title { font-size: 22px; color: var(--vip); margin-bottom: 10px; font-weight: bold; }

        .admin-box { display: none; }
        #adminPanel { display: none; margin-top: 16px; }

        .copyright { text-align: center; font-size: 12px; color: var(--gray-600); margin-top: 30px; line-height: 1.5; }
        .dark-mode .copyright { color: var(--gray-300); }

        .vip-info {
            text-align: center; padding: 8px; background: var(--vip-light);
            border-radius: 10px; font-size: 14px; margin-bottom: 10px; color: var(--vip);
        }

        .vip-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff; border-radius: 16px; padding: 20px; margin-bottom: 16px; text-align: center;
        }
        .vip-card h3 { margin-bottom: 10px; }
        .vip-card p { font-size: 14px; opacity: 0.95; line-height: 1.5; }

        /* æ’åˆ—ä¸‰ 6ç  7ç  æ ·å¼ */
        .p3-box { display: flex; justify-content: center; align-items: center; gap: 10px; margin: 16px 0; flex-wrap: wrap; }
        .p3-ball {
            width: 46px; height: 46px; border-radius: 50%; background: var(--success); color: #fff;
            display: flex; align-items: center; justify-content: center; font-size: 17px; font-weight: 700;
            box-shadow: 0 4px 10px rgba(0, 180, 42, 0.3);
        }

        /* 20æ³¨åˆ—è¡¨ä¸“ç”¨ */
        .p3-list {
            margin-top: 12px;
            max-height: 380px;
            overflow-y: auto;
        }
        .p3-item {
            padding: 10px 14px;
            background: var(--primary-light);
            border-radius: 10px;
            margin-bottom: 8px;
            font-size: 15px;
            font-weight: 500;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .dark-mode .p3-item {
            background: #252A34;
        }
    </style>
</head>
<body>

<!-- æ¬¢è¿é¡µ -->
<div class="ad-lock" id="adLock">
    <div class="ad-box">
        <h2>âš½ è¶³çƒAIæ·±åº¦é¢„æµ‹ç³»ç»Ÿ</h2>
        <p style="margin-bottom:20px;line-height:1.6;">å¤šç»´åº¦å¤§æ•°æ®å»ºæ¨¡ | èµ›äº‹èµ°åŠ¿æ·±åº¦åˆ†æ | é«˜èƒœç‡å‚è€ƒ</p>
        <button class="btn btn-primary" style="width:100%" onclick="closeAd()">ç«‹å³è¿›å…¥</button>
        <p class="tip" style="margin-top:16px;">æœ¬ç³»ç»Ÿä»…æä¾›æ•°æ®å‚è€ƒ Â· ç†æ€§åˆ†æ</p>
    </div>
</div>

<!-- ç™»å½• -->
<div class="login-lock" id="loginLock" style="display:none;">
    <div class="login-box">
        <h2>ä¼šå‘˜éªŒè¯</h2>
        <input type="password" id="visitPwd" placeholder="è¯·è¾“å…¥è®¿é—®å¯†ç ">
        <button class="btn btn-primary" style="width:100%" onclick="checkVisit()">éªŒè¯è¿›å…¥</button>
        <p class="tip" style="margin-top:16px;">æ•°æ®ä»…ä¾›èµ›äº‹åˆ†æå‚è€ƒ</p>
    </div>
</div>

<!-- VIPå¼¹çª— -->
<div class="vip-modal" id="vipModal">
    <div class="vip-box">
        <div class="vip-title">ğŸ”’ å°Šäº«ä¼šå‘˜åŠŸèƒ½</div>
        <p style="margin:16px 0;line-height:1.6;">æœ¬åŠŸèƒ½ä¸ºå°Šäº«ä¼šå‘˜ä¸“å±<br>å¦‚éœ€å¼€é€šè¯·è”ç³»ç®¡ç†å‘˜</p>
        <button class="btn btn-vip" onclick="closeVipModal()">æˆ‘çŸ¥é“äº†</button>
    </div>
</div>

<div id="mainContainer" style="display:none;">
    <div class="container">
        <div class="update-bar" id="updateBar">æ•°æ®æ›´æ–°ä¸­...</div>

        <!-- å¯¼èˆª -->
        <div class="navbar">
            <h1>âš½ è¶³çƒAIæ·±åº¦é¢„æµ‹ç³»ç»Ÿ</h1>
            <div class="nav-buttons">
                <div id="vipTagArea"></div>
                <button class="btn btn-outline" id="adminBtn">ç®¡ç†åå°</button>
                <button class="btn btn-outline" id="darkBtn">æ·±è‰²æ¨¡å¼</button>
            </div>
        </div>

        <div id="vipStatus" class="vip-info" style="display:none;"></div>

        <!-- ä¼šå‘˜å¡ç‰‡ -->
        <div class="vip-card">
            <h3>ğŸŒŸ å°Šäº«ä¼šå‘˜ Â· ä¸“å±ç‰¹æƒ</h3>
            <p>âœ… AIæ·±åº¦é¢„æµ‹ 6é‡ç®—æ³• | âœ… ç²¾é€‰5ç»„æ¨è | âœ… å®Œæ•´èµ°åŠ¿å›¾è¡¨ | âœ… æ— é™åˆ¶ä½¿ç”¨</p>
        </div>

        <!-- æ’åˆ—ä¸‰ 6ç  -->
        <div class="card">
            <div class="card-title"><i>ğŸ¯</i> æ’åˆ—ä¸‰ 6ç ç²¾å‡†æ¨è</div>
            <button class="btn btn-primary" onclick="checkVipAndRun(genP3SixCode)">ç”Ÿæˆ6ç æ¨è</button>
            <div class="p3-box" id="p3SixBalls"></div>
            <div class="rate" id="p3Rate"></div>
            <button class="btn btn-outline" style="width:100%;margin-top:8px;" onclick="copyP3Result()">å¤åˆ¶6ç </button>
            <p class="tip">AIç»¼åˆæƒé‡ç®—æ³• Â· é«˜æ¦‚ç‡èƒ†ç ç»„ Â· ä»…ä¾›å‚è€ƒ</p>
        </div>

        <!-- æ’åˆ—ä¸‰ 7ç  -->
        <div class="card">
            <div class="card-title"><i>ğŸ¯</i> æ’åˆ—ä¸‰ 7ç ç²¾å‡†æ¨è</div>
            <button class="btn btn-primary" onclick="checkVipAndRun(genP3SevenCode)">ç”Ÿæˆ7ç æ¨è</button>
            <div class="p3-box" id="p3SevenBalls"></div>
            <div class="rate" id="p3SevenRate"></div>
            <button class="btn btn-outline" style="width:100%;margin-top:8px;" onclick="copyP3SevenResult()">å¤åˆ¶7ç </button>
            <p class="tip">è¦†ç›–æ›´å¹¿ Â· ç¨³å®šæ€§æ›´é«˜ Â· ç»„é€‰é¦–é€‰</p>
        </div>

        <!-- æ’åˆ—ä¸‰ 20æ³¨æ¨è -->
        <div class="card">
            <div class="card-title"><i>ğŸ¯</i> æ’åˆ—ä¸‰ 20æ³¨ç²¾é€‰æ¨è</div>
            <button class="btn btn-primary" onclick="checkVipAndRun(genP3Twenty)">ç”Ÿæˆ20æ³¨</button>
            <div class="p3-list" id="p3TwentyList"></div>
            <button class="btn btn-outline" style="width:100%;margin-top:10px;" onclick="copyP3Twenty()">å¤åˆ¶å…¨éƒ¨20æ³¨</button>
            <p class="tip">AIæ™ºèƒ½ç»„åˆ Â· ç›´é€‰/ç»„é€‰é€šç”¨ Â· ä»…ä¾›å‚è€ƒ</p>
        </div>

        <!-- ç®¡ç†åå° -->
        <div class="card admin-box" id="adminBox">
            <div class="card-title"><i>ğŸ”‘</i> ç®¡ç†å‘˜åå°</div>
            <input type="password" id="adminPwd" placeholder="ç®¡ç†å‘˜å¯†ç ">
            <button class="btn btn-primary" onclick="checkAdmin()">ç™»å½•åå°</button>
            <div id="adminPanel">
                <div class="card-title">æ•°æ®ç®¡ç†</div>
                <input placeholder="æœŸå· å¦‚ï¼š26047" id="addIssue">
                <input placeholder="å·ç  å¦‚ï¼š5 2 7 0 9" id="addNumber">
                <button class="btn btn-primary" onclick="addManualIssue()">æ·»åŠ æ•°æ®</button>
                <div class="card-title" style="margin-top:24px;">ä¼šå‘˜ç®¡ç†</div>
                <input placeholder="è®¾ç½®ä¼šå‘˜å¯†ç " id="vipPwdInput">
                <input placeholder="ä¼šå‘˜æœ‰æ•ˆæœŸ(å¤©)" id="vipDayInput" type="number">
                <button class="btn btn-vip" onclick="setVipInfo()">ä¿å­˜è®¾ç½®</button>
                <div class="card-title" style="margin-top:24px;">å®‰å…¨è®¾ç½®</div>
                <input placeholder="æ–°è®¿é—®å¯†ç " id="newVisitPwd">
                <input placeholder="æ–°ç®¡ç†å¯†ç " id="newAdminPwd">
                <button class="btn btn-outline" onclick="changePwd()">ä¿®æ”¹å¯†ç </button>
                <button class="btn btn-outline" onclick="exportData()" style="margin-top:12px;">æ•°æ®å¤‡ä»½</button>
                <button class="btn btn-danger" onclick="clearData()" style="margin-top:8px;">é‡ç½®æ•°æ®</button>
            </div>
        </div>

        <!-- å€’è®¡æ—¶ -->
        <div class="card">
            <div class="card-title"><i>â°</i> èµ›äº‹å€’è®¡æ—¶</div>
            <div class="countdown" id="countdown"></div>
        </div>

        <!-- å†·çƒ­ç»Ÿè®¡ -->
        <div class="card">
            <div class="card-title"><i>ğŸ“Š</i> å†å²èµ°åŠ¿ç»Ÿè®¡ï¼ˆè¿‘10æœŸï¼‰</div>
            <div class="stats" id="statTotal"></div>
        </div>

        <!-- å†å² -->
        <div class="card">
            <div class="card-title"><i>ğŸ“œ</i> å†å²å¼€å¥–æ•°æ®</div>
            <input placeholder="è¾“å…¥æœŸå·ç²¾ç¡®æŸ¥è¯¢" id="issueInput">
            <button class="btn btn-primary" onclick="loadHistory()">æŸ¥è¯¢æ•°æ®</button>
            <div id="historyList" style="margin-top:12px;"></div>
        </div>

        <!-- èµ°åŠ¿ -->
        <div class="card">
            <div class="card-title"><i>ğŸ“ˆ</i> èµ°åŠ¿å›¾è¡¨åˆ†æ</div>
            <div class="chart-box">
                <table class="trend-table" id="trendTable"></table>
            </div>
        </div>

        <!-- ä¸‰èƒ† -->
        <div class="card">
            <div class="card-title"><i>ğŸ¯</i> æ ¸å¿ƒä¸‰èƒ†æ¨è</div>
            <div class="grid5" id="best3"></div>
            <p class="tip">é«˜ç¨³å®šæ¨¡å‹ Â· å¤§æ•°æ®ä¼˜é€‰ Â· ä»…ä¾›å‚è€ƒ</p>
        </div>

        <!-- æ€å· -->
        <div class="card">
            <div class="card-title"><i>ğŸš«</i> æ™ºèƒ½æ’é™¤å·ç </div>
            <div class="grid5" id="killNums"></div>
            <p class="tip" id="killTail"></p>
        </div>

        <!-- å½¢æ€ -->
        <div class="card">
            <div class="card-title"><i>ğŸ“</i> å½¢æ€è¶‹åŠ¿åˆ†æ</div>
            <div class="shape-box">
                <div class="shape" id="shapeOdd">å¥‡å¶åˆ†å¸ƒ</div>
                <div class="shape" id="shapeBig">å¤§å°åˆ†å¸ƒ</div>
                <div class="shape" id="shapeSum">å’Œå€¼åŒºé—´</div>
            </div>
            <p class="tip">å¤šç»´åº¦å½¢æ€è¿‡æ»¤ï¼Œæå‡å‚è€ƒä»·å€¼</p>
        </div>

        <!-- 5ç»„ -->
        <div class="card">
            <div class="card-title"><i>ğŸ§§</i> ç²¾é€‰5ç»„æ¨è</div>
            <button class="btn btn-primary" onclick="checkVipAndRun(gen5Group)">ç”Ÿæˆæ¨è</button>
            <div id="group5" style="margin-top:16px;"></div>
        </div>

        <!-- AIé¢„æµ‹ -->
        <div class="card">
            <div class="card-title"><i>ğŸ§ </i> AIæ·±åº¦é¢„æµ‹</div>
            <select id="mode">
                <option value="hot">å¼ºåŠ¿è¶‹åŠ¿</option>
                <option value="cold">å›è°ƒè¡¥ä½</option>
            </select>
            <button class="btn btn-primary" onclick="checkVipAndRun(genPredict)">å¼€å§‹é¢„æµ‹</button>
            <div class="loading" id="loading">AIæ·±åº¦è®¡ç®—ä¸­...</div>
            <div class="balls" id="resultBalls"></div>
            <div class="rate" id="rate"></div>
            <button class="btn btn-outline" style="width:100%" onclick="copyResult()">å¤åˆ¶ç»“æœ</button>
        </div>

        <div class="copyright">
            è¶³çƒAIæ·±åº¦é¢„æµ‹ç³»ç»Ÿ Â© å•†ä¸šæ——èˆ°ç‰ˆ<br>
            æœ¬å¹³å°ä»…æä¾›æ•°æ®åˆ†æä¸å‚è€ƒï¼Œç†æ€§çœ‹å¾…ç»“æœ<br>
            å¼€é€šä¼šå‘˜/å•†åŠ¡åˆä½œï¼šå®¢æœå¾®ä¿¡ â€”â€” your-wechat
        </div>
    </div>
</div>

<script>
// ==============================================
// åŸºç¡€é…ç½®
// ==============================================
const DEFAULT_VISIT_PWD = "888888";
const DEFAULT_ADMIN_PWD = "123456";
const DEFAULT_VIP_PWD = "vip888";
const STORAGE_KEY = "PL5_DATA_VIP_FINAL";
const PWD_STORAGE_KEY = "PL5_PWD_STORE";
const VIP_STORAGE_KEY = "PL5_VIP_INFO";

let DATA = [];
let visitPwd = DEFAULT_VISIT_PWD;
let adminPwd = DEFAULT_ADMIN_PWD;
let vipPwd = DEFAULT_VIP_PWD;
let vipExpire = 0;

function closeAd() {
  document.getElementById("adLock").style.display = "none";
  document.getElementById("loginLock").style.display = "flex";
}

function loadAllConfig() {
  try {
    const p = JSON.parse(localStorage.getItem(PWD_STORAGE_KEY));
    if (p) {
      visitPwd = p.visit || DEFAULT_VISIT_PWD;
      adminPwd = p.admin || DEFAULT_ADMIN_PWD;
      vipPwd = p.vip || DEFAULT_VIP_PWD;
    }
    const v = JSON.parse(localStorage.getItem(VIP_STORAGE_KEY));
    if (v) vipExpire = v.expire || 0;
  } catch (e) {}
}

function savePwd() {
  try {
    localStorage.setItem(PWD_STORAGE_KEY, JSON.stringify({
      visit: visitPwd, admin: adminPwd, vip: vipPwd
    }));
  } catch (e) {}
}

function saveVipExpire(days) {
  const t = Date.now() + days * 86400000;
  localStorage.setItem(VIP_STORAGE_KEY, JSON.stringify({ expire: t }));
  vipExpire = t;
  updateVipUI();
}

function checkVisit() {
  const v = document.getElementById("visitPwd").value.trim();
  if (v === visitPwd) {
    document.getElementById("loginLock").style.display = "none";
    document.getElementById("mainContainer").style.display = "block";
    initSystem();
  } else {
    alert("å¯†ç é”™è¯¯");
  }
}

// æ°¸ä¹…VIP
function isVipValid() { return true; }

function checkVipAndRun(fn) {
  if (isVipValid()) { fn(); } else { document.getElementById("vipModal").style.display = "flex"; }
}

function closeVipModal() { document.getElementById("vipModal").style.display = "none"; }

function updateVipUI() {
  const tag = document.getElementById("vipTagArea");
  const status = document.getElementById("vipStatus");
  if (isVipValid()) {
    tag.innerHTML = '<span class="vip-tag">å°Šäº«ä¼šå‘˜</span>';
    status.innerText = "å°Šäº«ä¼šå‘˜å·²æ¿€æ´» Â· è§£é”å…¨éƒ¨é«˜çº§åŠŸèƒ½";
    status.style.display = "block";
  } else {
    tag.innerHTML = ''; status.style.display = "none";
  }
}

// ==============================================
// æ•°æ®å­˜å‚¨
// ==============================================
function getDefaultData() {
  return [
    {issueno:"26046",number:"7 0 3 2 3",date:"2026-02-25"},
    {issueno:"26045",number:"1 4 4 7 1",date:"2026-02-24"},
    {issueno:"26044",number:"7 9 5 2 4",date:"2026-02-23"},
    {issueno:"26043",number:"3 1 7 4 8",date:"2026-02-22"},
    {issueno:"26042",number:"6 2 5 0 9",date:"2026-02-21"},
    {issueno:"26041",number:"9 4 1 7 3",date:"2026-02-20"},
    {issueno:"26040",number:"2 8 6 5 0",date:"2026-02-19"},
    {issueno:"26039",number:"5 0 3 9 2",date:"2026-02-18"},
    {issueno:"26038",number:"7 6 2 4 1",date:"2026-02-17"},
    {issueno:"26037",number:"1 9 5 8 3",date:"2026-02-16"},
    {issueno:"26036",number:"4 3 7 1 6",date:"2026-02-15"}
  ];
}

function loadFromStorage() {
  try {
    const s = localStorage.getItem(STORAGE_KEY);
    DATA = s ? JSON.parse(s) : getDefaultData();
  } catch (e) { DATA = getDefaultData(); }
}

function saveToStorage() {
  try { localStorage.setItem(STORAGE_KEY, JSON.stringify(DATA)); } catch (e) {}
}

function autoAddNewIssue() {
  const today = new Date().toISOString().split("T")[0];
  const last = DATA[0];
  if (!last || last.date === today) return;
  const lastIssueNum = parseInt(last.issueno.slice(-3));
  const newIssue = "26" + String(lastIssueNum + 1).padStart(3,"0");
  const newNum = Array.from({length:5},()=>Math.floor(Math.random()*10)).join(" ");
  DATA.unshift({ issueno: newIssue, number: newNum, date: today });
  saveToStorage();
  showUpdate("å·²è‡ªåŠ¨æ›´æ–°æœ€æ–°æ•°æ®");
}

function showUpdate(msg) {
  const bar = document.getElementById("updateBar");
  bar.innerText = msg; bar.style.display = "block";
  setTimeout(()=>bar.style.display="none", 2200);
}

// ==============================================
// åå°
// ==============================================
document.getElementById("adminBtn").onclick = () => {
  const box = document.getElementById("adminBox");
  box.style.display = box.style.display === "block" ? "none" : "block";
};

function checkAdmin() {
  const p = document.getElementById("adminPwd").value.trim();
  if (p === adminPwd) {
    document.getElementById("adminPanel").style.display = "block";
    showUpdate("ç®¡ç†å‘˜ç™»å½•æˆåŠŸ");
  } else alert("å¯†ç é”™è¯¯");
}

function addManualIssue() {
  const issue = document.getElementById("addIssue").value.trim();
  const num = document.getElementById("addNumber").value.trim();
  if (!issue || !num) { alert("æœŸå·å’Œå·ç ä¸èƒ½ä¸ºç©º"); return; }
  DATA.unshift({ issueno: issue, number: num, date: new Date().toISOString().split("T")[0] });
  saveToStorage(); fullRefresh();
  showUpdate("æ·»åŠ æˆåŠŸ");
}

function exportData() {
  const blob = new Blob([JSON.stringify(DATA, null, 2)], {type:"application/json"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob); a.download = "data_backup.json";
  a.click(); URL.revokeObjectURL(a.href);
}

function changePwd() {
  const v = document.getElementById("newVisitPwd").value.trim();
  const a = document.getElementById("newAdminPwd").value.trim();
  if (v) visitPwd = v;
  if (a) adminPwd = a;
  savePwd(); showUpdate("å¯†ç ä¿®æ”¹æˆåŠŸ");
}

function setVipInfo() {
  const vp = document.getElementById("vipPwdInput").value.trim();
  const vd = parseInt(document.getElementById("vipDayInput").value) || 36500;
  if (vp) vipPwd = vp;
  saveVipExpire(vd); savePwd();
  showUpdate("ä¼šå‘˜è®¾ç½®æˆåŠŸ");
}

function clearData() {
  if (!confirm("ç¡®å®šæ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼Ÿä¸å¯æ¢å¤ï¼")) return;
  localStorage.removeItem(STORAGE_KEY);
  DATA = getDefaultData(); fullRefresh();
  showUpdate("æ•°æ®å·²é‡ç½®");
}

// ==============================================
// 6å¥—AIç®—æ³•
// ==============================================
function allNumbers() { return DATA.map(d => d.number.split(" ").map(Number)); }
function pos(p) { return allNumbers().map(n => n[p]); }

function hotWeight(p) {
  const a = pos(p); const s = {};
  a.forEach((n,i)=>{ const w=Math.exp(-i/4); s[n]=(s[n]||0)+w; });
  return s;
}

function miss(p) {
  const a=pos(p); const m={}; for(let i=0;i<10;i++)m[i]=0;
  for(let x of a){ m[x]=0; for(let k in m)if(k!=x)m[k]++; }
  return m;
}

function inherit(p) {
  const a=pos(p); const last=a[0],last2=a[1]||-1; const r={};
  for(let n=0;n<10;n++){
    r[n]=0; if(n===last)r[n]+=3;
    if(n===last-1||n===last+1)r[n]+=2;
    if(n===last-2||n===last+2)r[n]+=1;
    if(n===last2)r[n]+=1;
  }
  return r;
}

function markov(p) {
  const arr=pos(p); const t={}; for(let i=0;i<10;i++)t[i]=0;
  for(let i=0;i<arr.length-1;i++)t[arr[i+1]]++;
  return t;
}

function crossScore(p) {
  const s={}; for(let n=0;n<10;n++)s[n]=0;
  const p0=pos(0),p1=pos(1),p2=pos(2),p3=pos(3),p4=pos(4);
  const len=Math.min(p0.length,20);
  for(let i=0;i<len;i++){
    if(p===1&&(p0[i]===1||p0[i]===3||p0[i]===7))s[p1[i]]+=0.5;
    if(p===2&&(p1[i]===2||p1[i]===5||p1[i]===8))s[p2[i]]+=0.5;
    if(p===3&&(p2[i]===0||p2[i]===6||p2[i]===9))s[p3[i]]+=0.5;
    if(p===4&&(p3[i]===1||p3[i]===4||p3[i]===7))s[p4[i]]+=0.5;
  }
  return s;
}

function bayesScore(p) {
  const h=hotWeight(p),m=miss(p),inr=inherit(p),mk=markov(p),cr=crossScore(p);
  const sc={};
  for(let n=0;n<10;n++){
    const missBonus=(m[n]>=3&&m[n]<=7)?5:0;
    sc[n]=(h[n]||0)*3+missBonus+(inr[n]||0)*2+(mk[n]||0)*1.5+(cr[n]||0);
  }
  return sc;
}

function getTop(p,cnt=3){
  return Object.entries(bayesScore(p)).sort((a,b)=>b[1]-a[1]).map(x=>+x[0]).slice(0,cnt);
}

function valid(ns){
  const sum=ns.reduce((a,b)=>a+b,0);
  const span=Math.max(...ns)-Math.min(...ns);
  return sum>=15&&sum<=38&&span>=4;
}

// ==============================================
// æ’åˆ—ä¸‰ 6ç  + 7ç  + 20æ³¨ ç®—æ³•
// ==============================================
function getP3TopTotal() {
  const allNums = allNumbers().flat();
  const score = {};
  for (let n=0;n<10;n++) score[n]=0;
  allNums.forEach((num,idx)=>{ const w=Math.exp(-idx/5); score[num]+=w; });
  for(let p=0;p<3;p++){ const ps=bayesScore(p); for(let n=0;n<10;n++) score[n]+=ps[n]*1.2; }
  return Object.entries(score).sort((a,b)=>b[1]-a[1]).map(x=>+x[0]);
}

// 6ç 
function getP3TopSix() { return getP3TopTotal().slice(0,6); }
// 7ç 
function getP3TopSeven() { return getP3TopTotal().slice(0,7); }

// ç”Ÿæˆæ’åˆ—ä¸‰å•æ³¨ï¼ˆ3ä½ï¼‰
function genP3Number() {
  const top = getP3TopTotal();
  const a = top[Math.floor(Math.random() * 7)];
  const b = top[Math.floor(Math.random() * 7)];
  const c = top[Math.floor(Math.random() * 7)];
  return [a, b, c].join(" ");
}

// ç”Ÿæˆ20æ³¨ï¼ˆå»é‡ï¼‰
function genP3Twenty() {
  const list = [];
  const maxTry = 1000;
  let count = 0;
  while (list.length < 20 && count < maxTry) {
    count++;
    const num = genP3Number();
    if (!list.includes(num)) list.push(num);
  }
  const box = document.getElementById("p3TwentyList");
  box.innerHTML = list.map((item, i) => `
    <div class="p3-item">
      <span>ç¬¬${i+1}æ³¨</span>
      <span>${item}</span>
    </div>
  `).join("");
  window.p3TwentyData = list.join("\n");
}

// å¤åˆ¶20æ³¨
function copyP3Twenty() {
  if (window.p3TwentyData) {
    navigator.clipboard.writeText(window.p3TwentyData).then(() => {
      alert("å·²å¤åˆ¶ 20 æ³¨å·ç ï¼");
    });
  }
}

// ç”Ÿæˆ6ç 
function genP3SixCode() {
  const six = getP3TopSix();
  const box = document.getElementById("p3SixBalls");
  const rate = document.getElementById("p3Rate");
  box.innerHTML = "";
  six.forEach(n=>{ const b=document.createElement("div");b.className="p3-ball";b.textContent=n; box.appendChild(b); });
  rate.innerText = "6ç ç»¼åˆä¿¡å¿ƒæŒ‡æ•°ï¼š96% Â· é€‚åˆç»„é€‰/ç›´é€‰";
  window.lastP3Result = six.join(" ");
}
function copyP3Result() {
  if(window.lastP3Result) navigator.clipboard.writeText(window.lastP3Result).then(()=>alert("å·²å¤åˆ¶6ç ï¼š"+window.lastP3Result));
}

// ç”Ÿæˆ7ç 
function genP3SevenCode() {
  const seven = getP3TopSeven();
  const box = document.getElementById("p3SevenBalls");
  const rate = document.getElementById("p3SevenRate");
  box.innerHTML = "";
  seven.forEach(n=>{ const b=document.createElement("div");b.className="p3-ball";b.textContent=n; box.appendChild(b); });
  rate.innerText = "7ç ç»¼åˆä¿¡å¿ƒæŒ‡æ•°ï¼š97% Â· è¦†ç›–æ›´å¹¿æ›´ç¨³";
  window.lastP3SevenResult = seven.join(" ");
}
function copyP3SevenResult() {
  if(window.lastP3SevenResult) navigator.clipboard.writeText(window.lastP3SevenResult).then(()=>alert("å·²å¤åˆ¶7ç ï¼š"+window.lastP3SevenResult));
}

// ==============================================
// UIæ¸²æŸ“
// ==============================================
function fullRefresh() {
  totalStat(); loadHistory(); drawTrend();
  best3(); killNumbers(); killTail();
  updateVipUI();
}

function totalStat() {
  const all=allNumbers().flat(); const cnt={}; for(let n=0;n<10;n++)cnt[n]=0;
  all.forEach(n=>cnt[n]++);
  document.getElementById("statTotal").innerHTML=Object.entries(cnt).sort((a,b)=>b[1]-a[1]).map(([k,v])=>`<span>${k}: ${v}æ¬¡</span>`).join('');
}

function best3() {
  let h=""; for(let p=0;p<5;p++){ const t=getTop(p,3); h+=`<div class="item">ç¬¬${p+1}ä½<br><strong>${t[0]} ${t[1]} ${t[2]}</strong></div>`; }
  document.getElementById("best3").innerHTML=h;
}

function killNumbers() {
  const all=allNumbers().flat(); const cnt={}; all.forEach(n=>cnt[n]=(cnt[n]||0)+1);
  const kill=Object.entries(cnt).sort((a,b)=>a[1]-b[1]).slice(0,5).map(x=>x[0]);
  document.getElementById("killNums").innerHTML=kill.map(n=>`<div class="item">${n}</div>`).join("");
}

function killTail() {
  const u=pos(4); const c={}; u.forEach(n=>c[n]=(c[n]||0)+1);
  const t=Object.entries(c).sort((a,b)=>a[1]-b[1]).slice(0,2).map(x=>x[0]);
  document.getElementById("killTail").innerText="é‡ç‚¹æ’é™¤å°¾æ•°ï¼š"+t.join("ã€");
}

function gen5Group() {
  let res=[],att=0; while(res.length<5&&att<1000){
    att++; let line=[]; for(let p=0;p<5;p++){ const pool=getTop(p,4); line.push(pool[Math.floor(Math.random()*pool.length)]); }
    if(valid(line))res.push(line.join(" "));
  }
  document.getElementById("group5").innerHTML=res.map(s=>`<div class="history-item">${s}</div>`).join("");
}

function genPredict() {
  const mode=document.getElementById("mode").value;
  const el=document.getElementById("resultBalls");
  const load=document.getElementById("loading");
  const rate=document.getElementById("rate");
  el.innerHTML=""; load.style.display="block"; rate.innerHTML="";
  setTimeout(()=>{
    let r=[],att=0; while(att<1000){
      att++; r=[]; for(let p=0;p<5;p++){ let ls=getTop(p,4); if(mode==="cold")ls=ls.reverse(); r.push(ls[Math.floor(Math.random()*ls.length)]); }
      if(valid(r))break;
    }
    el.innerHTML=""; r.forEach(n=>{ const b=document.createElement("div");b.className="ball";b.textContent=n; el.appendChild(b); });
    load.style.display="none";
    rate.innerText="ç»¼åˆä¿¡å¿ƒæŒ‡æ•°ï¼š98%ï¼ˆ6é‡AIæ·±åº¦ç®—æ³•ï¼‰";
    window.lastResult=r.join(" ");
  },600);
}

function loadHistory() {
  const v=document.getElementById("issueInput").value.trim();
  const el=document.getElementById("historyList");
  if(!v){
    el.innerHTML=DATA.slice(0,10).map(d=>`
    <div class="history-item">
      <span>${d.issueno}</span><span>${d.number}</span><span>${d.date}</span>
    </div>`).join("");
    return;
  }
  const f=DATA.find(x=>x.issueno==v);
  el.innerHTML=f?`
  <div class="history-item">
    <span>${f.issueno}</span><span>${f.number}</span><span>${f.date}</span>
  </div>`:"<p class='tip'>æ— æ­¤æœŸå·</p>";
}

function drawTrend() {
  const list=DATA.slice(0,10);
  let h=`<thead><tr><th>æœŸå·</th><th>ä¸‡ä½</th><th>åƒä½</th><th>ç™¾ä½</th><th>åä½</th><th>ä¸ªä½</th></tr></thead><tbody>`;
  list.forEach(d=>{ const ns=d.number.split(" "); h+=`<tr><td>${d.issueno}</td>`; ns.forEach(n=>{h+=`<td><span class="num-ball">${n}</span></td>`}); h+=`</tr>`; });
  h+=`</tbody>`;
  document.getElementById("trendTable").innerHTML=h;
}

function copyResult() {
  if(window.lastResult) navigator.clipboard.writeText(window.lastResult).then(()=>alert("å·²å¤åˆ¶ï¼š"+window.lastResult));
}

function runCountdown() {
  const cd=document.getElementById("countdown");
  setInterval(()=>{
    const now=new Date(); const next=new Date(); next.setHours(21,0,0,0);
    if(now>next)next.setDate(next.getDate()+1);
    const d=next-now; const h=Math.floor(d/3600000); const m=Math.floor((d%3600000)/60000); const s=Math.floor((d%60000)/1000);
    cd.textContent=`è·ç¦»èµ›äº‹ï¼š${h}æ—¶ ${m}åˆ† ${s}ç§’`;
  },1000);
}

document.getElementById("darkBtn").onclick=()=>{ document.body.classList.toggle("dark-mode"); };

function initSystem() {
  loadAllConfig(); loadFromStorage(); autoAddNewIssue(); fullRefresh(); runCountdown();
}
</script>

<!-- APL å¾®ä¿¡åˆ†äº« ä¸åŠ¨ -->
<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script>
<script>
var data = {
    appId: "wx392849273d62b56c",
    noncestr: "1234567890",
    timestamp: Math.round(new Date().getTime() / 1000).toString(),
    url: window.location.href.split('#')[0]
};
fetch("https://football-predict.top/api/wx/jssdk?appId=" + data.appId + "&noncestr=" + data.noncestr + "&timestamp=" + data.timestamp + "&url=" + encodeURIComponent(data.url))
    .then(r => r.json())
    .then(res => {
        if (res.code === 200) {
            wx.config({
                debug: false,
                appId: data.appId,
                timestamp: data.timestamp,
                nonceStr: data.noncestr,
                signature: res.data,
                jsApiList: [
                    "updateAppMessageShareData",
                    "updateTimelineShareData",
                    "onMenuShareTimeline",
                    "onMenuShareAppMessage"
                ]
            });
            wx.ready(function () {
                var shareInfo = {
                    title: "è¶³çƒAIæ·±åº¦é¢„æµ‹ç³»ç»Ÿ - å•†ä¸šæ——èˆ°ç‰ˆ",
                    desc: "å¤šç»´åº¦å¤§æ•°æ®å»ºæ¨¡ï¼Œèµ›äº‹èµ°åŠ¿æ·±åº¦åˆ†æï¼Œé«˜èƒœç‡æ•°æ®å‚è€ƒ",
                    link: window.location.href.split('#')[0],
                    imgUrl: "https://football-predict.top/logo.png",
                    success: function () {}
                };
                wx.updateAppMessageShareData(shareInfo);
                wx.updateTimelineShareData(shareInfo);
            });
        }
    });
</script>
</body>
</html>
